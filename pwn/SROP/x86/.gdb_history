i fu
b handle_signal
handle SIGINT nostop pass
r
frame 0
frame 1
frame 2
p ((struct sigcontext *)($ebp + 3 * 4))->eax
p/x ((struct sigcontext *)($ebp + 3 * 4))->eax
p/x ((struct sigcontext *)($ebp + 3 * 4))->esp
p/x ((struct sigcontext *)($ebp + 3 * 4))->eip
x/3i $eip
frame 1
x/3i $eip
frame 0
p/x ((struct sigcontext *)($ebp + 3 * 4))->eax
p/x ((struct sigcontext *)($ebp + 3 * 4))->esp
p/x ((struct sigcontext *)($ebp + 3 * 4))->eip
p/x &((struct sigcontext *)($ebp + 3 * 4))->esp
p/x *((struct sigcontext *)($ebp + 3 * 4))->esp
b 13
c
i r
bt
p __kernel_sigreturn
p sigreturn
vmmap
p/x 0xf7fc3590-0xf7d65000
quit
i fu
disass main
quit
i fu
disass main
disass vuln
b *vuln
r
i r esp
b *vuln+76
c
p/x 0xffffcc5c-0xffffcc1a
p/d 0x42
quit
b *vuln
r
diass vln
disass vuln
quit
disass vuln
quit
b *main
r
p __kernel_sigreturn
vmmap
p/x 0xf7fc3590-0xf7d65000
p printf
p/x 0xf7dbeb80-0xf7d65000
quit
quit
b *vuln
r
p __kernel_sigreturn
x/3i __kernel_sigreturn
quit
c
