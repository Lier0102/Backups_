p/d 0x32
p/x 40
p/x 44
quit
i fu
b *0x1506
x/i 0x1506
quit
b *0x159B
x/10i 0x159B
x/10i 0x1289
x/10i 0x1593
r
c
quit
quit
run
i fu
b *__libc_start_call_main
r
r
b *__libc_start_main
quit
r
c
quit
r
b *__libc_start_call_main
run
quit
run
b *__libc_start_call_main
run
b __libc_start_main
quit
i fu
quit
i fu
b __libc_start_main
set disassemble-next-line on
set follow-fork-mode parent
b __libc_start_main
b __libc_start_call_main
start
b __libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x   0x5555555559dc-0x555555555000
p/x   0x5555555559dc-0x555555554000
b *0x555555556637

c
quit
!cat flag 
!ls
!cat flag.txt
start
b *__libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x 0x5555555559dc-0x555555555000
p/x 0x5555555559dc-0x555555554000
p/x 0x555555554000+0x1637'
p/x 0x555555554000+0x1637
b *0x555555555637
c
i r rax
x/3gx $rax
quit
start
b *__libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x 0x555555554000+0x1637
b *0x555555555637
c
bt
x/gx $rdi
x/20gx $rdi
x40gx $rdi
x/40gx $rdi
x/s 0x4453414644414141
x/s 0x7fffffffdfe0+0x8
x/s 0x7fffffffdff0
x/s 0x7fffffffdff0+0x8
x/s 0x7fffffffdff0-0x8
x/s 0x7fffffffdff0-0x10
x/gx $rdi
x/gx $rdi+0x8
x/gx $rdi+24
x/gx $rdi+40
x/80gx $rdi
x/80gx $rsi
x/gx $rdi+40
x/gx $rsi+40
p/d 0x20
!ROPgadget --binary ./petpals
!ROPgadget --binary ./petpals | grep "rdi"
!ROPgadget --binary ./petpals | grep "pop"
!ROPgadget --binary ./petpals | grep "rax"
!ROPgadget --binary ./petpals | grep "pop rax"
!ROPgadget --binary ./petpals | grep "syscall"
!ls -al
!cat .gdb_history 
stop
quit
start
b *__libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x 0x555555554000+0x1637
b *0x555555555637
c
quit
start
b *__libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x 0x5555555559dc-0x555555554000
p/x 0x555555554000+0x1637
b *0x555555555637
c
x/40gx $rdi
x/40gx $rsi
c
quit
start
b *__libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x 0x555555554000+0x1637
p/x 0x555555554000+0x1665
b *0x555555555665
c
x/40gx $rdi
x/40gx $rsi
x/40gx $rax
x/40gx $eax
x/40gx $rax
c
quit
start
b *__libc_start_call_main
c
vmmap
p/x 0x5555555559dc-0x555555554000
p/x 0x555555554000+0x1665
b *0x555555555665
c
x/40gx $rdi
x/40gx $rax
c
quit
start
b *__libc_start_main
c
vmmap
p/x 0x5555555559dc-0x555555554000
p/x 0x555555554000+0x166A
b *0x55555555566a
c
x/40gx $rdi
x/40gx $ra
x/40gx $rax
c
quit
start
b *__libc_start_call_main
c
vmmap
p/x 0x555555554000+0x1665
b *0x555555555665
c
i r eax
x/gx 0xffffdfb0

bt
disass 0x0000555555555665
x/gx $rbp-0x8
x/40gx *(void**)($rbp-0x8)
x/40gx *(void*)($rbp-0x8)
x/40gx *(void**)($rbp-0x8)
set $a1 = *(void**)($rbp-0x8)
set $a2 = *(void**)($rbp-0x10)
x/wx $a1
x/wx $a2
set *(int *)$a2 = 0
x/wx $a2
c
x/wx $a2
x/wx $a1
set *(int *)$a1 = 0
c
quit
!clear
start
b *__libc_start_call_main
c
b *0x5555555559dc
c
vmmap
p/x 0x555555554000+0x17FF
c
b *printf@plt
start
b *printf@plt
p printf
b *printf
c
c
c
c
c
c
info threads
info thread
quit
start
b *__libc_start_main
c
vmmap
quit
